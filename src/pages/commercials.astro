---
import { Image } from "astro:assets";
import VimeoLightbox from "../components/VimeoLightbox.astro";
import playBlack from '../assets/play_black-solid.png';
import playWhite from '../assets/play_white-solid.png';
import Layout from '../layouts/Layout.astro';
import TermsConditions from '../components/TermsConditions.astro';
let page = await fetch('https://cms.tompataki.com/wp-json/wp/v2/pages/31?_embed&acf_format=standard').then((r) => r.json());
let commercials = await fetch('https://cms.tompataki.com/wp-json/wp/v2/commercials?_embed&per_page=100&acf_format=standard', {cache: "no-store",}).then((r) => r.json());
---

<Layout bodyClass="page-template-page-commercials" description="Commercials I was working on">

    <section id="commercials">
        <h1>{page.title.rendered}</h1>
        <ul role="navigation" aria-label="Commercials list">
            {
                commercials.map((commercial) => 
                    <li class="play">
                        <a href={commercial.acf.commercial_video_url}>
                            <p>{commercial.acf.title_in_list}</p>
                        </a>
                    </li>
                )
            }
        </ul>
        <div class="grid-gap">
            {
                commercials.map((commercial) => 
                    <div class="grid-item" id={`commercial-${commercial.id}`}>
                        <div class="grid-item-image" style={`--aspect-ratio: 16/9;`}>
                            <Image src={commercial._embedded['wp:featuredmedia'][0].source_url} alt={commercial.title.rendered} width="400" height="227" sizes="(max-width: 500px) 400px, 450px" loading="lazy" />
                            <div id="grid-details">
                                <p>directed by
                                    <span>{commercial.acf.directed_by}</span>
                                </p>
                                <h2 set:html={commercial.title.rendered}></h2>
                                <div class="play">
                                    { commercial.id == 134 || commercial.id == 122 ?

                                        <VimeoLightbox url={`${commercial.acf.commercial_video_url}?dnt=1`}>
                                            <Image src={playBlack.src} alt="Play" width="45" height="45" sizes="(max-width: 50px) 45px, 45px" loading="lazy" />
                                        </VimeoLightbox>

                                        :

                                        <VimeoLightbox url={`${commercial.acf.commercial_video_url}?dnt=1`}>
                                            <Image src={playWhite.src} alt="Play" width="45" height="45" sizes="(max-width: 50px) 45px, 45px" loading="lazy" />
                                        </VimeoLightbox>
                                    }

                                </div>
                                <p>{commercial.acf.sub_title}</p>
                            </div>
                        </div>
                        <div class="grid-item-position">
                            <span>{commercial.acf.position}</span>
                        </div>
                    </div>
                )
            }
        </div>
    </section>

    <TermsConditions />
    
</Layout>
