---
import loadIcon from '../assets/load.gif';
import searchIcon from '../assets/search.svg';
import logoBlack from '../assets/logo-black.png';
import { Image } from "astro:assets";

---

    <!-- <div class="preloader-wrapper">
        <div class="preloader">
            <img src={loadIcon.src} alt="loading...">
        </div>
    </div> -->

    <section id="header">
        <div id="headline">
            <a href="/">
                <Image src={logoBlack.src} alt="Tom Pataki logo" width="192" height="18" sizes="(max-width: 250px) 180px, 192px" loading="lazy" />
            </a>
            <span>EN | HU</span>
        </div>
        <div id="navbar">

            <div id="navbar-wrapper">
                <div class="menu-main-menu-container">
                    <ul id="menu-main-menu" class="menu">
                        <li id="menu-item-265" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-265"><a href="/feature-films">Feature films / Series</a></li>
                        <li id="menu-item-64" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-64"><a href="/commercials">Commercials</a></li>
                        <li id="menu-item-63" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-63"><a href="/special-projects">Special projects</a></li>
                        <li id="menu-item-62" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-62"><a href="/showreel">Showreel</a></li>
                        <li id="menu-item-61" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-61"><a href="/about">About</a></li>
                        <li id="menu-item-60" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-60"><a href="/contact">Contact</a></li>
                    </ul>
                </div>
                <img src={searchIcon.src} alt="Search" id="searchButton" width="16" height="16">
            </div>

        </div>
    </section>
    <div id="search-overlay">
        <div id="search-overlay-wrapper">
            <span id="searchClose">X</span>
            <form role="search" method="get" id="searchform" action="/search">
                <div>
                    <label for="q">Search anything and hit enter</label>
                    <input type="text" value="" name="q" id="q" placeholder="Search" />
                    <input type="submit" id="searchsubmit" value="Search" class="button" />
                </div>
            </form>
        </div>
    </div>
    <section id="mobile-header">
        <div id="logo">
            <a href="/">
                <Image src={logoBlack.src} alt="Tom Pataki logo" width="192" height="18" sizes="(max-width: 250px) 180px, 192px" loading="lazy" />
            </a>
        </div>
        <div id="menu">
            <a href="javascript:void(0);" style="font-size:15px;" class="icon" onclick="mobileMenu()">&#9776;</a>
        </div>
        <div id="mobile-navbar" class="mobile-nav">

            <div class="menu-main-menu-container">
                <ul id="menu-main-menu-1" class="menu">
                    <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-265"><a href="/feature-films">Feature films / Series</a></li>
                    <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-64"><a href="/commercials">Commercials</a></li>
                    <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-63"><a href="/special-projects">Special projects</a></li>
                    <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-62"><a href="/showreel">Showreel</a></li>
                    <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-61"><a href="/about">About</a></li>
                    <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-60"><a href="/contact">Contact</a></li>
                </ul>
            </div>

        </div>
    </section>

<script>
  const btn = document.getElementById("searchButton");
  const overlay = document.getElementById("search-overlay");
  const close = document.getElementById("searchClose");
  const input = document.getElementById("s") || document.getElementById("q");

  function openSearch() {
    overlay?.classList.add("is-open");
    // kis delay, hogy a megjelenés után fókuszáljon
    setTimeout(() => input?.focus(), 50);
  }
  function closeSearch() {
    overlay?.classList.remove("is-open");
  }

  btn?.addEventListener("click", openSearch);
  close?.addEventListener("click", closeSearch);

  // kattintás overlay háttérre zárjon (ha a wrapperen kívül kattintasz)
  overlay?.addEventListener("click", (e) => {
    if (e.target === overlay) closeSearch();
  });

  // ESC zár
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") closeSearch();
  });
</script>

<style>
#search-overlay { display: none; }
#search-overlay.is-open { display: block; }
</style>