---
import { Image } from "astro:assets";

interface Slide {
  id?: number | string;
  title?: string;
  subtitle?: string;
  href?: string;
  image?: string; // URL
}

const { slides = [] } = Astro.props as { slides: Slide[] };
---

<section class="container">
  <h2 class="h2">Newest projects</h2>

  <div class="snap-slider">
    <div class="snap-track" data-track>
      {slides.map((s, i) => (
        <article class="snap-slide" key={s.id ?? i}>
          <a href={s.href ?? "#"} aria-label={s.title ?? `Slide ${i + 1}`}>
            {s.image ? (
              // sima <img> URL-es képre (WP-ről jön), ezért nem Astro Image
              <img class="snap-media" src={s.image} alt={s.title ?? ""} loading={i === 0 ? "eager" : "lazy"} />
            ) : (
              <div class="snap-media" />
            )}

            <div class="snap-meta">
              <h3 class="snap-title">{s.title ?? ""}</h3>
              {s.subtitle ? <p class="snap-subtitle">{s.subtitle}</p> : null}
            </div>
          </a>
        </article>
      ))}
    </div>

    <button class="snap-next" type="button" data-next>
      Next <span aria-hidden="true">→</span>
    </button>
  </div>

  <script is:inline>
    const root = document.currentScript.closest(".snap-slider");
    const track = root?.querySelector("[data-track]");
    const btn = root?.querySelector("[data-next]");

    const next = () => {
      if (!track) return;
      const firstSlide = track.querySelector(".snap-slide");
      const step = firstSlide ? firstSlide.getBoundingClientRect().width : 320;
      track.scrollBy({ left: step + 14, behavior: "smooth" });
    };

    btn?.addEventListener("click", next);
  </script>
</section>